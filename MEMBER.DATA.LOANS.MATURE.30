[ -----------------------------------------------------------------
  BUSINESS.LOANS - Dan Mellor
  Finds all business loans (types 60-65, 81).

  Modified by Connor Blakeney
  Finds all business loans that are maturing in 30 days. 
  ----------------------------------------------------------------- ]

TARGET=LOAN

DEFINE
 FOUNDAPP                = CHARACTER
 LTV                     = RATE
 APPID                   = CHARACTER
 INSURANCEEXPIRATIONDATE = DATE
 FINANCIALREVIEWDATE     = DATE
 RISKRATING              = NUMBER
 COUNTER                 = NUMBER
END

SELECT
 ACCOUNT:CLOSEDATE='--/--/--' AND
 ACCOUNT:NUMBER<"9000000000" AND
 LOAN:CLOSEDATE='--/--/--' AND
  (LOAN:MATURITYDATE >= SYSTEMDATE AND
  LOAN:MATURITYDATE<=(SYSTEMDATE+30)) AND
 (LOAN:TYPE=60 OR
  LOAN:TYPE=61 OR
  LOAN:TYPE=62 OR
  LOAN:TYPE=63 OR
  LOAN:TYPE=64 OR
  LOAN:TYPE=65 OR
  LOAN:TYPE=66 OR
  LOAN:TYPE=67 OR
  LOAN:TYPE=81) 
END


PRINT TITLE="BUSINESS LOANS MATURING IN 30 DAYS"
 HEADER="Account No Name          ID Ty        Org Amt   Org Dt        Cur Bal        Payment   Due Dt      LTV    Mature"
 HEADER="----------------------------------------------------------------------------------------------------------------"

 LTV=0.00%
 FOUNDAPP="N"
 APPID=LOAN:APPLICATIONID

 FOR ACCOUNT ACCOUNT:NUMBER
 DO
   FOR EACH LOANAPP WITH (LOANAPP:ID=APPID)
   DO
     LTV=LOANAPP:LOANTOVALUERATIO
     FOUNDAPP="Y"
   END
   UNTIL (FOUNDAPP="Y")
 END

 INSURANCEEXPIRATIONDATE='--/--/--'
 FOR EACH LOAN TRACKING WITH (LOAN TRACKING:TYPE=36 AND
  LOAN TRACKING:EXPIREDATE='--/--/--')
 DO
   INSURANCEEXPIRATIONDATE=LOAN TRACKING:USERDATE2
 END

 FINANCIALREVIEWDATE='--/--/--'
 RISKRATING=0
 FOR EACH LOAN TRACKING WITH (LOAN TRACKING:TYPE=50 AND
  LOAN TRACKING:EXPIREDATE='--/--/--')
 DO
   FINANCIALREVIEWDATE=LOAN TRACKING:USERDATE1
   RISKRATING=LOAN TRACKING:USERNUMBER1
 END

 COL=001 ACCOUNT:NUMBER
 COL=012 SEGMENT(NAME:SHORTNAME,1,13)
 COL=026 LOAN:ID
 COL=030 LOAN:TYPE
 COL=044 LOAN:LRLNBALANCE
 COL=054 LOAN:LRLNDATE
 COL=068 LOAN:BALANCE
 COL=083 LOAN:PAYMENT
 COL=093 LOAN:DUEDATE
 COL=102 LTV
 COL=111 LOAN:MATURITYDATE
 NEWLINE
 COUNTER=COUNTER+1

END

TOTAL
 PRINT "---------------------------------------------------------------------------------------------------------------------------"
 NEWLINE
 COL=001 "Total:"
 COL=016 COUNTER
 NEWLINE
END

[ Report Format:
  Account No  Name              LID  Ty        Orig Amt  Orig Date        Curr Bal         Payment  Due Date       LTV  Next Ins  Next Fin  Risk
  xxxxxxxxxx  xxxxxxxxxxxxxxxx   xx  xx  99,999,999.99-   xx/xx/xx  99,999,999.99-  99,999,999.99-  xx/xx/xx  xxxx.xxx  xx/xx/xx  xx/xx/xx    xx
  000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000111111111111111111111111111111111
  000000000111111111122222222223333333333444444444455555555556666666666777777777788888888889999999999000000000011111111112222222222333
  123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012

  Account No Name             LID Ty       Org Amt     Org Dt        Cur Bal        Payment   Due Dt      LTV  Nxt Ins  Nxt Fin  Risk
  xxxxxxxxxx xxxxxxxxxxxxxxxx  xx xx 99,999,999.99-  xx/xx/xx 99,999,999.99- 99,999,999.99- xx/xx/xx xxxx.xxx xx/xx/xx xx/xx/xx    xx xx/xx/xx
  000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000111111111111111111111111111111111
  000000000111111111122222222223333333333444444444455555555556666666666777777777788888888889999999999000000000011111111112222222222333
  123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012

  Account No Name          ID Ty        Org Amt   Org Dt        Cur Bal        Payment   Due Dt      LTV  Ins Exp  Nxt Fin   Review Rk
  xxxxxxxxxx xxxxxxxxxxxxx xx xx 99,999,999.99- xx/xx/xx 99,999,999.99- 99,999,999.99- xx/xx/xx xxxx.xxx xx/xx/xx xx/xx/xx xx/xx/xx xx
  000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000111111111111111111111111111111111
  000000000111111111122222222223333333333444444444455555555556666666666777777777788888888889999999999000000000011111111112222222222333
  123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012

  Account No Name          ID Ty        Org Amt   Org Dt        Cur Bal        Payment   Due Dt      LTV  Ins Exp  Fin Rev Rk
  xxxxxxxxxx xxxxxxxxxxxxx xx xx 99,999,999.99- xx/xx/xx 99,999,999.99- 99,999,999.99- xx/xx/xx xxxx.xxx xx/xx/xx xx/xx/xx xx
  000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000111111111111111111111111111111111
  000000000111111111122222222223333333333444444444455555555556666666666777777777788888888889999999999000000000011111111112222222222333
  123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012

]




